<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="copyright" content="&copy; 2022 Wladislaw Waag" />
  <title>CAN-Gateway installation</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <style>
  a { color: #0000EE; cursor: pointer; text-decoration: underline;}
  </style>
  <script
    type="module"
    src="https://unpkg.com/esp-web-tools@9.2.1/dist/web/install-button.js?module"
  ></script>
</head>
<body>
<div class="container m-2 p-0">
  <h3>CAN-Gateway Software Installation</h3>
  <div class="form-floating mb-1">
  <select id="lang" onchange="LangChanged();" class="form-select" aria-label="" style="min-width: 200px; width:auto;">
        <option value="0">Deutsch</option>
        <option value="1">English</option>
  </select>
  <label for="lang">Language/Sprache:</label>
  </div>
</div></small>
<br>
  <div id="FullContainer1">
		
	<h5 id="L23">Vorgehensweise:</h5>
      <ol>
          <li><span id="L01">Schliessen Sie Ihr ESP32 Board/ CAN-Gateway Board an USB an</span></li>
          <div></div>
          <li><span id="L02">Wählen Sie den Board-Typ/Software Version aus</span></li>
          <div></div>
          <li><span id="L03">Klicken Sie auf "Installieren" und wählen dann den korrekten COM-Port aus</span><u><a onclick="NoComPortHelp()" class="btn btn-secondary btn-sm"><span id="L04">Kein Board wurde gefunden?</span></a></u></li>
          <div id="comporthelp"></div>
          <li><span id="L05">Klicken Sie auf "Install CAN-GATEWAY". Die Installation beginnt</span></li>
      </ol>
	</div>
		  <div class="form-floating">
			<select id="software_version" onchange="selectSoftware();" class="form-select" aria-label="" style="min-width: 20em; width:auto;">
           <optgroup label="Version 29.330 DEMO">
              <option data-manifest_file="/cangw/manifest_v8_rc.json" data-download_file="/cangw/CAN_Gateway_V29_330_DEMO_HWV7.bin"><span id="L06">CAN-Gateway Demo for CAN-Gateway development board V8</span></option>
              <option data-manifest_file="/cangw/manifest_v5_rc.json" data-download_file="/cangw/CAN_Gateway_V29_330_DEMO_HWV5.bin"><span id="L07">CAN-Gateway Demo for CAN-Gateway HW V5</span></option>
              <option data-manifest_file="/cangw/manifest_olimex_rc.json" data-download_file="/cangw/CAN_Gateway_V29_330_DEMO_HWVOlimex.bin"><span id="L08">CAN-Gateway Demo for Olimex ESP32-EVB(-EA) board</span></option>
            </optgroup>
	</select>
				<label for="software_version"><span id="L11">Board Typ / SW Version:</span></label>
		  </div> 
	<div id="FullContainer2">
		<br>
	  <div class="container inst-button">
          <esp-web-install-button id="install_btn" manifest="/cangw/manifest.json" >
            <button class="btn btn-primary" slot="activate"><span id="L09">Installieren<span></button>
          </esp-web-install-button>
      </div>
    </div>
	<div>
		<br>
		<div class="container download-button">
	      <a href="" class="btn btn-primary" id="download_btn"><span id="L20">Nur die .bin Datei herunterladen (später manuell installieren)</span></a>
	    </div>
	</div>
  <hr>
        <div>
        <h5 id="L15">Nach der Installation:</h5>
        <ul>
          <li><span id="L12">Erste Schritte: <a href="https://github.com/wladwnt/CAN-Gateway/wiki/Inbetriebnahme">Wiki zu Inbetriebnahmeauf Github</a></span></li>
          <li><span id="L13">Vollversion erwerben: </span><a href="https://shop.myhome-control.de">shop.myhome-control.de</a></li>
          <li><span id="L14">Zurück zu Projektseite: <a href="https://github.com/wladwnt/CAN-Gateway/">Projektseite auf Github</a></span></li>

        </ul>
      </div>
   <div class="accordion accordion-flush" id="accordionBottom">
		<div class="accordion-item">
			<h4 class="accordion-header" id="headingImprint">
			  <button class="accordion-button collapsed" style="padding-left:0;" type="button" data-bs-toggle="collapse" data-bs-target="#collapseImprint" aria-expanded="true" aria-controls="collapseOne">
				<span id="L18" style="color:blue;text-decoration: underline;">Impressum</span>
			  </button>
			</h4>
			<div id="collapseImprint" class="accordion-collapse collapse" aria-labelledby="headingImprint" data-bs-parent="#accordionBottom">
			  <div class="accordion-body">
				<small><div id="imprint"></div></small>
			  </div>
			</div>
		</div>
		
		<div class="accordion-item">
			<h4 class="accordion-header" id="headingPrivacy">
			  <button class="accordion-button collapsed" style="padding-left:0;" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePrivacy" aria-expanded="true" aria-controls="collapseOne">
				<span id="L19" style="color:blue;text-decoration: underline;">Datenschutzerklärung</span>
			  </button>
			</h4>
			<div id="collapsePrivacy" class="accordion-collapse collapse" aria-labelledby="headingPrivacy" data-bs-parent="#accordionBottom">
			  <div class="accordion-body">
				<small><div id="dataprivacy"></div></small>
			  </div>
			</div>
		</div>
	  </div>
</div>
<script>
function LangChanged() {
    if(document.getElementById('lang').selectedIndex==0) {
         if(document.getElementById('L10')) document.getElementById('L10').innerHTML = "Leider wird Ihr Browser aktuell nicht unterstützt!<br>Bitte versuchen Sie mit Google Chrome (für Desktop) oder Microsoft Edge.";
        if(document.getElementById('L01')) document.getElementById('L01').innerHTML = "Schliessen Sie Ihr ESP32 Board/ CAN-Gateway Board an USB an.";
        if(document.getElementById('L02')) document.getElementById('L02').innerHTML = "Wählen Sie den Board-Typ aus";
        if(document.getElementById('L03')) document.getElementById('L03').innerHTML = "Klicken Sie auf \"Installieren\" und wählen dann den korrekten COM-Port aus. ";
        if(document.getElementById('L04')) document.getElementById('L04').innerHTML = "Kein Board wurde gefunden?";
        if(document.getElementById('L05')) document.getElementById('L05').innerHTML = "Klicken Sie auf \"Install CAN-GATEWAY\"";
        if(document.getElementById('L06')) document.getElementById('L06').innerHTML = "CAN-Gateway Demo für CAN-Gateway development board V8";
        if(document.getElementById('L07')) document.getElementById('L07').innerHTML = "CAN-Gateway Demo für CAN-Gateway HW V5";
        if(document.getElementById('L08')) document.getElementById('L08').innerHTML = "CAN-Gateway Demo für Olimex ESP32-EVB(-EA) board";
        if(document.getElementById('L09')) document.getElementById('L09').innerHTML = "Installieren";
        if(document.getElementById('L11')) document.getElementById('L11').innerHTML = "Board Typ: ";
        if(document.getElementById('L12')) document.getElementById('L12').innerHTML = "Erste Schritte: <a href=\"https://github.com/wladwnt/CAN-Gateway/wiki/Inbetriebnahme\">Wiki zu Inbetriebnahme</a>";
        if(document.getElementById('L13')) document.getElementById('L13').innerHTML = "Vollversion erwerben: ";
        if(document.getElementById('L14')) document.getElementById('L14').innerHTML = "Zurück zu Projektseite: <a href=\"https://github.com/wladwnt/CAN-Gateway/\">Projektseite auf Github</a>";
        if(document.getElementById('L15')) document.getElementById('L15').innerHTML = "Nach der Installation:";
        if(document.getElementById('L18')) document.getElementById('L18').innerHTML = 'Impressum';
        if(document.getElementById('L19')) document.getElementById('L19').innerHTML = 'Datenschutzerklärung';  
		if(document.getElementById('L20')) document.getElementById('L20').innerHTML = 'Nur die .bin Datei herunterladen (später manuell installieren)';  		
    } else {
       if(document.getElementById('L10')) document.getElementById('L10').innerHTML = "Unfortunately your browser is not yet supported!<br>Please try on Chrome (for Desktop) or Microsoft Edge.";
        if(document.getElementById('L01')) document.getElementById('L01').innerHTML = "Connect your ESP32 board/ CAN-Gateway board via USB port";
        if(document.getElementById('L02')) document.getElementById('L02').innerHTML = "Select type of your board";
        if(document.getElementById('L03')) document.getElementById('L03').innerHTML = "Click on \"Install\" and select the correct COM port. ";
        if(document.getElementById('L04')) document.getElementById('L04').innerHTML = "No board found?";
        if(document.getElementById('L05')) document.getElementById('L05').innerHTML = "Click on \"Install CAN-GATEWAY\"";
        if(document.getElementById('L06')) document.getElementById('L06').innerHTML = "CAN-Gateway Demo for CAN-Gateway development board V8";
        if(document.getElementById('L07')) document.getElementById('L07').innerHTML = "CAN-Gateway Demo for CAN-Gateway HW V5";
        if(document.getElementById('L08')) document.getElementById('L08').innerHTML = "CAN-Gateway Demo for Olimex ESP32-EVB(-EA) board";
        if(document.getElementById('L09')) document.getElementById('L09').innerHTML = "Install";
        if(document.getElementById('L11')) document.getElementById('L11').innerHTML = "Board type: ";
        if(document.getElementById('L12')) document.getElementById('L12').innerHTML = "First steps: <a href=\"https://github.com/wladwnt/CAN-Gateway/wiki/First-Usage\">Wiki</a>";
        if(document.getElementById('L13')) document.getElementById('L13').innerHTML = "Buy unlimited version: ";
        if(document.getElementById('L14')) document.getElementById('L14').innerHTML = "Back to project page: <a href=\"https://github.com/wladwnt/CAN-Gateway/\">Project on Github</a>";
        if(document.getElementById('L15')) document.getElementById('L15').innerHTML = "After install:";
        if(document.getElementById('L18')) document.getElementById('L18').innerHTML = 'Imprint';
        if(document.getElementById('L19')) document.getElementById('L19').innerHTML = 'Data privacy';
		if(document.getElementById('L20')) document.getElementById('L20').innerHTML = 'Only download .bin file (to install later manually)'; 
    }
	ShowImprint();
	ShowDataPrivacy();
}

function selectSoftware() {
    var selected = document.getElementById('software_version');
    var manifest_file = selected.options[selected.selectedIndex].dataset.manifest_file;
	
	if(document.getElementById('install_btn')) document.getElementById('install_btn').setAttribute('manifest',manifest_file);
	
	var download_file = selected.options[selected.selectedIndex].dataset.download_file;
	document.getElementById('download_btn').setAttribute('href',download_file);
	
}
  
function ShowImprint() {
    if(document.getElementById('lang').selectedIndex==0) {
        document.getElementById('imprint').innerHTML = "<br><h3>Impressum</h3>Angaben gemäß § 5 TMG:<br>Verantwortlicher: Wladislaw Waag<br>Adresse: Wasserburger Landstr. 29, 81825 München, Deutschland<br>Kontakt: +49 (0) 176 47 11 5206, info@myhome-control.de<br><br>EU-Streitschlichtung: Die Europäische Kommission stellt eine Plattform zur Online-Streitbeilegung (OS) bereit: <a href='https://ec.europa.eu/consumers/odr/' target='_blank'>https://ec.europa.eu/consumers/odr/</a>.<br><br>Verbraucherstreitbeilegung/Universalschlichtungsstelle: Wir sind nicht bereit oder verpflichtet, an Streitbeilegungsverfahren vor einer Verbraucherschlichtungsstelle teilzunehmen.";
    } else {
        document.getElementById('imprint').innerHTML = "<br><h3>Legal notice</h3>Information according to § 5 TMG:<br>Responsible: Wladislaw Waag<br>Address: Wasserburger Landstr. 29, 81825 Munich, Germany<br>Contact: +49 176 47 11 5206, info@myhome-control.de<br><br>EU dispute settlement: The European Commission provides a platform for online dispute resolution (ODR): <a href='https://ec.europa.eu/consumers/odr/' target='_blank'>https://ec.europa.eu/consumers/odr/</a>.<br><br>Consumer dispute settlement / universal arbitration board: We are neither willing nor obliged to participate in dispute settlement proceedings before a consumer arbitration board.";
    }
}
  
function ShowDataPrivacy() {
    if(document.getElementById('lang').selectedIndex==0) {
        document.getElementById('dataprivacy').innerHTML = "<br><h3>Datenschutzerklärung</h3>Der Betreiber dieser Webseite (https://wladwnt.github.io) sammelt und verarbeitet keinerlei personenbezogenen Daten der Nutzer dierser Webseite. Diese Seite wird jedoch im Rahmen von 'Github Pages' gehostet und betrieben. Es ist möglich und wahrscheinlich, dass Github die personenbezogenen Daten sammelt und verarbeitet. Das betrifft dann auch die Besucher der Webseite wladwnt.github.io. Ich habe aber keinerlei Einfluss darauf. Bitte lesen Sie dazu die Datenschutzerklärung von Github: <a href='https://docs.github.com/en/github/site-policy/github-privacy-statement' target='_blank'>https://docs.github.com/en/github/site-policy/github-privacy-statement</a><br><br>Unsere Webseite enthält Links zu externen Webseiten Dritter, auf deren Inhalte wir keinen Einfluss haben. Für diese fremden Inhalte können wir keine Gewähr und keine Haftung übernehmen. Für die Inhalte der verlinkten Seiten ist immer der jeweilige Anbieter oder Betreiber der Seiten verantwortlich. Die verlinkten Seiten wurden zum Zeitpunkt der Verlinkung auf mögliche Rechtsverstöße überprüft. Rechtswidrige Inhalte waren dabei nicht erkennbar. Sollten uns Rechtsverletzungen bekannt werden, werden wir die entsprechende Verlinkung umgehend entfernen.";
    } else {
        document.getElementById('dataprivacy').innerHTML = "<br><h3>Data privacy</h3>The operator of this website (https://wladwnt.github.io) does not collect and process any personal data of the users of this website. However, this page is hosted and operated as part of 'Github Pages'. It is possible and probable that Github collects and processes personal data, which then also affects visitors of the wladwnt.github.io web page. But I have no influence on it. Please read the Github privacy statement: <a href='https://docs.github.com/en/github/site-policy/github-privacy-statement' target='_blank'>https://docs.github.com/en/github/site-policy/github-privacy-statement</a><br><br>Our website contains links to external websites over which we have no control. We cannot accept any liability for this third-party content. The respective provider or operator of the pages is always responsible for the content of the linked pages. The linked pages were checked for possible legal violations at the time of linking. Illegal content was not recognizable at that time. If we become aware of any legal violations, we will remove the relevant link immediately.";
    }
}

function NoComPortHelp() {
    document.getElementById('L04').innerHTML = "";
    if(document.getElementById('lang').selectedIndex==0) {
        document.getElementById('comporthelp').innerHTML = "Ist Dein USB Kabel geeignet für Datentransfer ?<br><br>Vielelicht fehlt der USB Treiber für Dein Board. Die meisten Boards verwenden einen von diesen:<br>- Viele fertige ESP32 Module: <a href=\"https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers\" target=\"_blank\">CP210x (quadratischer Chip)</a><br>- Olimex, CAN-Gateway dev board: <a href=\"http://www.wch-ic.com/downloads/CH341SER_EXE.html\" target=\"_blank\">CH34x (Rechteck Chip)</a><br><br>";
    } else {
        document.getElementById('comporthelp').innerHTML = "Check if your USB cable supports data transfer.<br><br>Eventually you have to install the drivers for your board.<br>Here are drivers commonly used in ESP32 boards:<br>- often used in vaious modules: <a href=\"https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers\" target=\"_blank\">CP210x (small square chip)</a><br>- used on CAN-Gateway dev board, Olimex board: <a href=\"http://www.wch-ic.com/downloads/CH341SER_EXE.html\" target=\"_blank\">CH34x (rectangular chip)</a><br><br>";
    }
}

window.onload = function () {
    if (document.getElementById('install_btn').hasAttribute('install-unsupported')) {
        if(document.getElementById('lang').selectedIndex==0) {
            document.getElementById('FullContainer1').innerHTML = "<span id=\"L10\" style=\"color: red\">Leider wird Ihr Browser für die Installation über USB aktuell nicht unterstützt!<br>Bitte versuchen Sie mit Google Chrome (für Desktop) oder Microsoft Edge.<br><br>Verfügbare software Versionen:</span><br>";
        } else {
            document.getElementById('FullContainer1').innerHTML = "<span id=\"L10\" style=\"color: red\">Unfortunately your browser is not yet supported for installation via USB!<br>Please try on Chrome (for Desktop) or Microsoft Edge.<br><br>Available software versions:</span><br>";
        }
		document.getElementById('FullContainer2').style.display="none";
    }
	selectSoftware();
	LangChanged();
};
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
</body>
</html>
