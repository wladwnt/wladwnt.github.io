<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CAN Gateway installation</title>
  <style>
  a { color: #0000EE; cursor: pointer; text-decoration: underline;}
  div {padding-bottom: 10px;}
 .select-wrapper {
    position: relative;
    width: 500px;
  }
 .button-wrapper {
   position: relative;
   width: 500px;
 }
body {
  background-color: #66CCFF;
  font-family: 'Open Sans', sans-serif;
  font-size: 16px;
}

#lang {width: 500px;}
#software_version {width: 500px;}
select, button {
  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #3399FF;
  border: none;
  border-radius: 3px;
  box-shadow: 2px 2px 5px 1px rgba(0,0,0,.3);
  color: #fff;
  cursor: pointer;
  font-family: 'Open Sans', sans-serif;
  font-size: 16px;
  height: 40px;
  outline: none;
  padding-left: 10px;
}

button {width: 500px;}

select option {
  color: #FFF;
}
.select-wrapper::before {
  content: "\1F853";
  font-size: 20px;
  position: absolute;
  right: 15px;
  top: 10px;
  color: #fff;
  pointer-events: none;
}
select::-ms-expand {
  display: none;
}
select:focus::-ms-value {
  background-color: transparent;
}
  </style>
  <script
    type="module"
    src="https://unpkg.com/esp-web-tools@6.1.1/dist/web/install-button.js?module"
  ></script>
</head>
<body>
  <h2>CAN-Gateway Software Installation</h2>
  <div>Language/Sprache:
  <div class="select-wrapper">
  <select id="lang" onchange="LangChanged();">
        <option value="0">Deutsch</option>
        <option value="1">English</option>
  </select></div></div>
  <div id="FullContainer">
      <ol>
          <li><span id="L01">Schliessen Sie Ihr ESP32 Board/ CAN-Gateway Board an USB an.</span></li>
          <div></div>
          <li><span id="L02">Wählen Sie den Board-Typ aus</span></li>
          <div></div>
          <li><span id="L03">Klicken Sie auf "Installieren" und wählen dann den korrekten COM-Port aus. </span><a onclick="NoComPortHelp()"><span id="L04">Kein Board wurde gefunden?</span></a></li>
          <div id="comporthelp"></div>
          <li><span id="L05">Klicken Sie auf "Install CAN-GATEWAY"</span></li>
      </ol><br>
      <div class="container inst-button">
          <div><span id="L11">Board Typ: </span>
          <div class="select-wrapper">
          <select id="software_version" onchange="selectSoftware()">
            <optgroup label="Version 29.100 (based on esp-idf v3.3)">
              <option data-manifest_file="/cangw/manifest_v8.json"><span id="L06">CAN-Gateway Demo for CAN-Gateway development board V8</span></option>
              <option data-manifest_file="/cangw/manifest_v5.json"><span id="L07">CAN-Gateway Demo for CAN-Gateway HW V5</span></option>
              <option data-manifest_file="/cangw/manifest_olimex.json"><span id="L08">CAN-Gateway Demo for Olimex ESP32-EVB(-EA) board</span></option>
            </optgroup>
            <optgroup label="Version 29.201 (based on esp-idf v4.4)">
              <option data-manifest_file="/cangw/manifest_v8_rc.json"><span id="L06">CAN-Gateway Demo for CAN-Gateway development board V8</span></option>
              <option data-manifest_file="/cangw/manifest_v5_rc.json"><span id="L07">CAN-Gateway Demo for CAN-Gateway HW V5</span></option>
              <option data-manifest_file="/cangw/manifest_olimex_rc.json"><span id="L08">CAN-Gateway Demo for Olimex ESP32-EVB(-EA) board</span></option>
            </optgroup>
          </select>
          </div>
          </div><br>
          <esp-web-install-button id="install_btn" manifest="/cangw/manifest.json" >
            <button slot="activate"><span id="L09">Installieren<span></button>
          </esp-web-install-button>
     </div>
  </div>
        <hr>
        <div>
        <span id="L15">Nach der Installation:</span>
        <ul>
          <li><span id="L12">Erste Schritte: <a href="https://github.com/wladwnt/CAN-Gateway/wiki/Inbetriebnahme">Wiki zu Inbetriebnahme</a></span></li>
          <li><span id="L13">Vollversion erwerben: </span><a href="https://shop.myhome-control.de">shop.myhome-control.de</a></li>
          <li><span id="L14">Zurück zu Projektseite: <a href="https://github.com/wladwnt/CAN-Gateway/">Projektseite auf Github</a></span></li>
        </ul>
      </div>
<script>
function LangChanged() {
    if(document.getElementById('lang').selectedIndex==0) {
        if(document.getElementById('L10')) document.getElementById('L10').innerHTML = "Leider wird Ihr Browser aktuell nicht unterstützt!<br>Bitte versuchen Sie mit Google Chrome (für Desktop) oder Microsoft Edge.";
        if(document.getElementById('L01')) document.getElementById('L01').innerHTML = "Schliessen Sie Ihr ESP32 Board/ CAN-Gateway Board an USB an.";
        if(document.getElementById('L02')) document.getElementById('L02').innerHTML = "Wählen Sie den Board-Typ aus";
        if(document.getElementById('L03')) document.getElementById('L03').innerHTML = "Klicken Sie auf \"Installieren\" und wählen dann den korrekten COM-Port aus. ";
        if(document.getElementById('L04')) document.getElementById('L04').innerHTML = "Kein Board wurde gefunden?";
        if(document.getElementById('L05')) document.getElementById('L05').innerHTML = "Klicken Sie auf \"Install CAN-GATEWAY\"";
        if(document.getElementById('L06')) document.getElementById('L06').innerHTML = "CAN-Gateway Demo für CAN-Gateway development board V8";
        if(document.getElementById('L07')) document.getElementById('L07').innerHTML = "CAN-Gateway Demo für CAN-Gateway HW V5";
        if(document.getElementById('L08')) document.getElementById('L08').innerHTML = "CAN-Gateway Demo für Olimex ESP32-EVB(-EA) board";
        if(document.getElementById('L09')) document.getElementById('L09').innerHTML = "Installieren";
        if(document.getElementById('L11')) document.getElementById('L11').innerHTML = "Board Typ: ";
        if(document.getElementById('L12')) document.getElementById('L12').innerHTML = "Erste Schritte: <a href=\"https://github.com/wladwnt/CAN-Gateway/wiki/Inbetriebnahme\">Wiki zu Inbetriebnahme</a>";
        if(document.getElementById('L13')) document.getElementById('L13').innerHTML = "Vollversion erwerben: ";
        if(document.getElementById('L14')) document.getElementById('L14').innerHTML = "Zurück zu Projektseite: <a href=\"https://github.com/wladwnt/CAN-Gateway/\">Projektseite auf Github</a>";
        if(document.getElementById('L15')) document.getElementById('L15').innerHTML = "Nach der Installation:";
      
    } else {
        if(document.getElementById('L10')) document.getElementById('L10').innerHTML = "Unfortunately your browser is not yet supported!<br>Please try on Chrome (for Desktop) or Microsoft Edge.";
        if(document.getElementById('L01')) document.getElementById('L01').innerHTML = "Connect your ESP32 board/ CAN-Gateway board via USB port";
        if(document.getElementById('L02')) document.getElementById('L02').innerHTML = "Select type of your board";
        if(document.getElementById('L03')) document.getElementById('L03').innerHTML = "Click on \"Install\" and select the correct COM port. ";
        if(document.getElementById('L04')) document.getElementById('L04').innerHTML = "No board found?";
        if(document.getElementById('L05')) document.getElementById('L05').innerHTML = "Click on \"Install CAN-GATEWAY\"";
        if(document.getElementById('L06')) document.getElementById('L06').innerHTML = "CAN-Gateway Demo for CAN-Gateway development board V8";
        if(document.getElementById('L07')) document.getElementById('L07').innerHTML = "CAN-Gateway Demo for CAN-Gateway HW V5";
        if(document.getElementById('L08')) document.getElementById('L08').innerHTML = "CAN-Gateway Demo for Olimex ESP32-EVB(-EA) board";
        if(document.getElementById('L09')) document.getElementById('L09').innerHTML = "Install";
        if(document.getElementById('L11')) document.getElementById('L11').innerHTML = "Board type: ";
        if(document.getElementById('L12')) document.getElementById('L12').innerHTML = "First steps: <a href=\"https://github.com/wladwnt/CAN-Gateway/wiki/First-Usage\">Wiki</a>";
        if(document.getElementById('L13')) document.getElementById('L13').innerHTML = "Buy unlimited version: ";
        if(document.getElementById('L14')) document.getElementById('L14').innerHTML = "Back to project page: <a href=\"https://github.com/wladwnt/CAN-Gateway/\">Project on Github</a>";
        if(document.getElementById('L15')) document.getElementById('L15').innerHTML = "After install:";
      
    }
    document.getElementById('comporthelp').innerHTML ="";
}

function selectSoftware() {
    var selected = document.getElementById('software_version');
    var manifest_file = selected.options[selected.selectedIndex].dataset.manifest_file;
    document.getElementById('install_btn').setAttribute('manifest',manifest_file);
}

function NoComPortHelp() {
    document.getElementById('L04').innerHTML = "";
    if(document.getElementById('lang').selectedIndex==0) {
        document.getElementById('comporthelp').innerHTML = "<br>Ist Dein USB Kabel geeignet für Datentransfer ?<br><br>Vielelicht fehlt der USB Treiber für Dein Board. Die meisten Boards verwenden einen von diesen:<br>- Viele fertige ESP32 Module: <a href=\"https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers\" target=\"_blank\">CP210x (quadratischer Chip)</a><br>- Olimex, CAN-Gateway dev board: <a href=\"http://www.wch-ic.com/downloads/CH341SER_EXE.html\" target=\"_blank\">CH34x (Rechteck Chip)</a><br><br>";
    } else {
        document.getElementById('comporthelp').innerHTML = "<br>Check if your USB cable supports data transfer.<br><br>Eventually you have to install the drivers for your board.<br>Here are drivers commonly used in ESP32 boards:<br>- often used in vaious modules: <a href=\"https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers\" target=\"_blank\">CP210x (small square chip)</a><br>- used on CAN-Gateway dev board, Olimex board: <a href=\"http://www.wch-ic.com/downloads/CH341SER_EXE.html\" target=\"_blank\">CH34x (rectangular chip)</a><br><br>";
    }
}

window.onload = function () {
    if (document.getElementById('install_btn').hasAttribute('install-unsupported')) {
        if(document.getElementById('lang').selectedIndex==0) {
            document.getElementById('FullContainer').innerHTML = "<span id=\"L10\">Leider wird Ihr Browser aktuell nicht unterstützt!<br>Bitte versuchen Sie mit Google Chrome (für Desktop) oder Microsoft Edge.</span><br>"; 
        } else {
            document.getElementById('FullContainer').innerHTML = "<span id=\"L10\">Unfortunately your browser is not yet supported!<br>Please try on Chrome (for Desktop) or Microsoft Edge.</span><br>";
        }
    } else {
        selectSoftware();
    }
};
</script>
</body>
</html>
